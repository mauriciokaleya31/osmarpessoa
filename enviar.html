<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reserva Webinar CX</title>
  <style>
    :root{
      --bg1:#050505;
      --bg2:#121212;
      --accent:#ffcc00;
      --accent-dark:#e6ac00;
      --card:#0d0d0d;
      --muted:#cfcfcf;
      --success:#00b894;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background:linear-gradient(135deg,var(--bg1) 0%, var(--bg2) 100%);
      color:#fff;
      padding:24px;
    }

    .card{
      width:100%;
      max-width:760px;
      border-radius:14px;
      padding:26px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      box-shadow: 0 10px 40px rgba(0,0,0,0.6), 0 0 60px rgba(255,204,0,0.06);
      overflow:hidden;
    }

    h1{
      margin:0 0 12px 0;
      font-size:20px;
      color:var(--accent);
      text-align:center;
      letter-spacing:0.2px;
    }
    p.lead{margin:0 0 18px 0;color:var(--muted);text-align:center}

    .columns{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:18px;
    }
    @media (max-width:760px){ .columns{grid-template-columns:1fr;} }

    label{display:block;font-size:13px;color:#ddd;margin-bottom:6px}
    input[type="text"], input[type="email"], select, textarea, input[type="file"]{
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.04);
      background:#0b0b0b;
      color:#fff;
      font-size:14px;
    }
    textarea{min-height:86px;resize:vertical}

    .btn{
      display:inline-block;
      width:100%;
      padding:12px;
      border-radius:10px;
      border:none;
      background:linear-gradient(90deg,var(--accent) 0%, var(--accent-dark) 100%);
      color:#111;
      font-weight:700;
      cursor:pointer;
      font-size:15px;
      margin-top:8px;
    }

    .muted{color:var(--muted);font-size:13px;margin-top:8px}

    .iban-box{
      background:#080808;
      padding:12px;
      border-radius:10px;
      border:1px solid rgba(255,204,0,0.06);
      color:var(--accent);
      font-size:14px;
    }
    .iban-row{display:flex;gap:10px;align-items:center;margin:8px 0}
    .iban-row strong{display:block;color:#fff;font-size:14px}
    .iban-small{font-size:13px;color:#ddd}

    .hidden{display:none!important}

    .center{text-align:center}
    .top-row{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:14px}
    .flag{font-size:18px;margin-right:6px}

    /* loader overlay */
    .overlay{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,0.55);
      z-index:9999;
      color:#fff;
      flex-direction:column;
      gap:12px;
    }
    .spinner{
      width:52px;height:52px;border-radius:50%;border:6px solid rgba(255,255,255,0.08);border-top-color:var(--accent);
      animation:spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    .success-card{padding:18px;border-radius:10px;background:linear-gradient(90deg, rgba(0,200,132,0.06), rgba(0,150,136,0.03)); color:#bff6df}
    .actions{display:flex;gap:10px;margin-top:12px}
    .actions .btn{flex:1}
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>Reserva â€” Webinar de IntroduÃ§Ã£o Ã  ExperiÃªncia do Cliente (CX)</h1>
    <p class="lead">Preencha os seus dados. Depois escolha a forma de pagamento e envie tudo pelo WhatsApp.</p>

    <!-- ETAPA 1 -->
    <div id="step1">
      <div class="columns">
        <div>
          <label>Nome</label>
          <input id="nome" type="text" placeholder="Seu nome completo" required>

          <label style="margin-top:12px">WhatsApp</label>
          <input id="whatsapp" type="text" placeholder="+244 9xx xxx xxx" required>

          <label style="margin-top:12px">E-mail</label>
          <input id="email" type="email" placeholder="seu@exemplo.com" required>
        </div>

        <div>
          <label>PaÃ­s</label>
          <select id="pais" required>
            <option value="">-- Selecione --</option>
            <option value="Angola">ðŸ‡¦ðŸ‡´ Angola</option>
            <option value="MoÃ§ambique">ðŸ‡²ðŸ‡¿ MoÃ§ambique</option>
            <option value="Portugal">ðŸ‡µðŸ‡¹ Portugal</option>
            <option value="Brasil">ðŸ‡§ðŸ‡· Brasil</option>
          </select>

          <label style="margin-top:12px">Objetivo</label>
          <textarea id="objetivo" placeholder="O que pretende aprender / objetivo com o webinar"></textarea>
        </div>
      </div>

      <div style="margin-top:14px;">
        <button id="btnNext" class="btn">Seguinte â€” Escolher pagamento</button>
        <p class="muted center">Ao avanÃ§ar serÃ¡ apresentada a tabela de IBANs e valores.</p>
      </div>
    </div>

    <!-- ETAPA 2 -->
    <div id="step2" class="hidden">
      <h2 style="color:var(--accent);font-size:18px;margin:6px 0">Dados para Pagamento</h2>

      <div class="iban-box" id="ibans">
        <div class="iban-row">
          <div><span class="flag">ðŸ‡²ðŸ‡¿</span><strong>MoÃ§ambique</strong></div>
          <div style="margin-left:auto" class="iban-small">IBAN: <b>MZ59004300000003384300625</b></div>
        </div>
        <div class="iban-row">
          <div><span class="flag">ðŸ‡¦ðŸ‡´</span><strong>Angola</strong></div>
          <div style="margin-left:auto" class="iban-small">IBAN: <b>0040.0000.8793.3704.1014.2</b></div>
        </div>
        <div class="iban-row">
          <div><span class="flag">ðŸ‡µðŸ‡¹</span><strong>Portugal</strong></div>
          <div style="margin-left:auto" class="iban-small">IBAN: <b>PT50 0007 0000 0067 0559 5462 3</b></div>
        </div>
        <div class="iban-row">
          <div><span class="flag">ðŸ‡§ðŸ‡·</span><strong>Brasil</strong></div>
          <div style="margin-left:auto" class="iban-small">Sem PIX â€” solicitar detalhes por WhatsApp</div>
        </div>

        <hr style="border:0;border-top:1px dashed rgba(255,255,255,0.04);margin:10px 0">

        <div style="display:flex;gap:10px;flex-wrap:wrap;">
          <div style="padding:8px;background:rgba(255,255,255,0.02);border-radius:8px">ðŸ‡¦ðŸ‡´ Kwanza: <b>25,000</b></div>
          <div style="padding:8px;background:rgba(255,255,255,0.02);border-radius:8px">ðŸ‡²ðŸ‡¿ Metical: <b>1,700</b></div>
          <div style="padding:8px;background:rgba(255,255,255,0.02);border-radius:8px">ðŸ‡µðŸ‡¹ Euro: <b>23</b></div>
        </div>
      </div>

      <div style="margin-top:12px">
        <label>Selecione a conta para depÃ³sito</label>
        <select id="contaSelecionada">
          <option value="MoÃ§ambique">ðŸ‡²ðŸ‡¿ MoÃ§ambique â€” MZ59004300000003384300625</option>
          <option value="Angola">ðŸ‡¦ðŸ‡´ Angola â€” 0040.0000.8793.3704.1014.2</option>
          <option value="Portugal">ðŸ‡µðŸ‡¹ Portugal â€” PT50 0007 0000 0067 0559 5462 3</option>
          <option value="Brasil">ðŸ‡§ðŸ‡· Brasil â€” Solicitar detalhes por WhatsApp</option>
        </select>

        <label style="margin-top:12px">Upload do comprovativo (opcional)</label>
        <input id="comprovativo" type="file" accept="image/*,application/pdf">

        <p class="muted">Recomendado: enviar tambÃ©m o comprovativo como anexo diretamente no WhatsApp depois de abrir o chat, caso o upload falhe.</p>

        <div style="display:flex;gap:10px;margin-top:8px">
          <button id="btnBack" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff">Voltar</button>
          <button id="btnSend" class="btn" style="flex:1">Enviar pelo WhatsApp</button>
        </div>
      </div>
    </div>

    <!-- SUCESSO / OBRIGADO -->
    <div id="stepSuccess" class="hidden center">
      <div class="success-card">
        <h3 style="margin:0;color:var(--accent)">Obrigado! PreparÃ¡mos a sua mensagem.</h3>
        <p style="margin:8px 0;color:#d7f6e6">SerÃ¡ aberta a conversa no WhatsApp com todas as informaÃ§Ãµes â€” confirme e envie (pode anexar o comprovativo manualmente se preferir).</p>
        <div class="actions">
          <button id="btnContact" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.07);color:#fff">Entrar em contacto</button>
          <button id="btnBackSite" class="btn">Voltar ao site</button>
        </div>
      </div>
    </div>

  </div>

  <!-- overlay processing -->
  <div id="overlay" class="overlay hidden" aria-hidden="true">
    <div class="spinner" aria-hidden="true"></div>
    <div>A processar â€” por favor aguarde...</div>
  </div>

<script>
  // Config
  const WA_NUMBER = "244952670034"; // sem +, sem espaÃ§os
  const MIN_PROCESS_MS = 2500; // tempo mÃ­nimo de "processamento" (ms)

  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const stepSuccess = document.getElementById('stepSuccess');
  const overlay = document.getElementById('overlay');

  const btnNext = document.getElementById('btnNext');
  const btnBack = document.getElementById('btnBack');
  const btnSend = document.getElementById('btnSend');
  const btnContact = document.getElementById('btnContact');
  const btnBackSite = document.getElementById('btnBackSite');

  // Inputs
  const nomeEl = document.getElementById('nome');
  const whatsappEl = document.getElementById('whatsapp');
  const emailEl = document.getElementById('email');
  const paisEl = document.getElementById('pais');
  const objetivoEl = document.getElementById('objetivo');
  const comprovativoEl = document.getElementById('comprovativo');
  const contaSel = document.getElementById('contaSelecionada');

  btnNext.addEventListener('click', () => {
    // validaÃ§Ã£o simples
    if(!nomeEl.value.trim()){ alert('Por favor escreva o seu nome.'); nomeEl.focus(); return; }
    if(!whatsappEl.value.trim()){ alert('Por favor escreva o seu WhatsApp.'); whatsappEl.focus(); return; }
    if(!emailEl.value.trim()){ alert('Por favor insira o seu email.'); emailEl.focus(); return; }
    if(!paisEl.value){ alert('Por favor selecione o seu paÃ­s.'); paisEl.focus(); return; }

    // AvanÃ§a para a etapa 2
    step1.classList.add('hidden');
    step2.classList.remove('hidden');

    // ajustar conta selecionada por defeito
    // (opcional) marcar a conta correspondente ao paÃ­s selecionado
    if(paisEl.value === 'Angola') contaSel.value = 'Angola';
    if(paisEl.value === 'MoÃ§ambique') contaSel.value = 'MoÃ§ambique';
    if(paisEl.value === 'Portugal') contaSel.value = 'Portugal';
  });

  btnBack.addEventListener('click', () => {
    step2.classList.add('hidden');
    step1.classList.remove('hidden');
  });

  // upload endpoint (coloque upload.php no mesmo diretÃ³rio)
  const UPLOAD_ENDPOINT = 'upload.php'; // se nÃ£o quiser upload no servidor, deixe como null

  async function uploadFile(file){
    if(!UPLOAD_ENDPOINT) return { success:false, url:null };

    const fd = new FormData();
    fd.append('comprovativo', file);
    try {
      const res = await fetch(UPLOAD_ENDPOINT, { method:'POST', body: fd });
      const data = await res.json();
      return data; // espera { success:true, url:"..." }
    } catch(err){
      console.error('upload failed', err);
      return { success:false };
    }
  }

  btnSend.addEventListener('click', async () => {
    const start = Date.now();
    overlay.classList.remove('hidden');
    overlay.setAttribute('aria-hidden','false');

    // gather data
    const nome = nomeEl.value.trim();
    const whatsappUser = whatsappEl.value.trim();
    const email = emailEl.value.trim();
    const pais = paisEl.value;
    const objetivo = objetivoEl.value.trim();
    const conta = contaSel.value;
    const file = comprovativoEl.files[0] || null;

    // escolher valor por paÃ­s
    const valores = {
      'Angola': 'ðŸ‡¦ðŸ‡´ Kwanza: 25,000',
      'MoÃ§ambique': 'ðŸ‡²ðŸ‡¿ Metical: 1,700',
      'Portugal': 'ðŸ‡µðŸ‡¹ Euro: 23',
      'Brasil': 'ðŸ‡§ðŸ‡· Solicitar detalhes (sem PIX)'
    };
    const valorText = valores[conta] || '';

    // tenta fazer upload do comprovativo (se existir)
    let comprovativoURL = null;
    if(file){
      const upRes = await uploadFile(file);
      if(upRes && upRes.success && upRes.url) comprovativoURL = upRes.url;
    }

    // criar mensagem personalizada
    let message = [];
    message.push('ðŸŸ¡ *Nova Reserva â€” Webinar CX*');
    message.push('');
    message.push(`*Nome:* ${nome}`);
    message.push(`*WhatsApp:* ${whatsappUser}`);
    message.push(`*Email:* ${email}`);
    message.push(`*PaÃ­s:* ${pais}`);
    if(objetivo) message.push(`*Objetivo:* ${objetivo}`);
    message.push('');
    message.push('*MÃ©todo de pagamento escolhido:* ' + conta);
    message.push('*Valor sugerido:* ' + valorText);
    if(conta === 'MoÃ§ambique') message.push('IBAN: MZ59004300000003384300625');
    if(conta === 'Angola') message.push('IBAN: 0040.0000.8793.3704.1014.2');
    if(conta === 'Portugal') message.push('IBAN: PT50 0007 0000 0067 0559 5462 3');
    if(conta === 'Brasil') message.push('Brasil â€” solicite detalhes por WhatsApp (sem PIX).');

    if(comprovativoURL){
      message.push('');
      message.push('*Comprovativo (anexado):* ' + comprovativoURL);
      message.push('');
      message.push('Enviei o comprovativo atravÃ©s do formulÃ¡rio. Por favor confirmar recepÃ§Ã£o.');
    } else {
      message.push('');
      message.push('*Comprovativo:* (anexe o comprovativo na conversa do WhatsApp se jÃ¡ tiver efectuado o pagamento)');
    }

    message.push('');
    message.push('Obrigado. â€” Webinar CX');

    const text = message.join('\n');

    // garante que o overlay fique pelo menos MIN_PROCESS_MS
    const elapsed = Date.now() - start;
    const wait = Math.max(0, MIN_PROCESS_MS - elapsed);
    await new Promise(r => setTimeout(r, wait));

    // abrir WhatsApp
    const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(text)}`;
    window.open(url, '_blank');

    overlay.classList.add('hidden');
    overlay.setAttribute('aria-hidden','true');

    // mostrar pÃ¡gina de obrigado no mesmo local (ou redirecionar)
    step2.classList.add('hidden');
    stepSuccess.classList.remove('hidden');
  });

  // success actions
  btnContact.addEventListener('click', () => {
    // abrir conversa no WhatsApp com o nÃºmero oficial
    window.open(`https://wa.me/${WA_NUMBER}`, '_blank');
  });
  btnBackSite.addEventListener('click', () => {
    window.location.href = '/';
  });
</script>
</body>
</html>
